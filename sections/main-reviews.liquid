<div class="full-bleed flex flex-col h-[680px] xl:h-[730px] py-10 ">
    <div class="bg-gray-100 h-full w-full flex flex-col md:py-10 py-7">
        <div class="text-center md:pb-10 py-2 px-5">
            <h2 class="text-xl md:text-3xl font-semibold text-[#6f6a5e]">
                {{ section.settings.title }}
            </h2>
        </div>

    
        <div class="collection-content-reviews overflow-hidden px-10 h-full">

            <div class="sliderTrack flex transition-transform duration-500 ease-out">
                
                {% for block in section.blocks %}
                <div class="shrink-0 md:w-1/3 lg:w-1/4 xl:w-1/5 w-[300px] lg:px-2 px-3 py-5 h-[450px]">

                    <div class="bg-white rounded-3xl lg:p-5 p-3 shadow-sm border border-gray-200 h-full flex flex-col items-center text-center">

                        <!-- Imagen -->
                        {% assign product = all_products[block.settings.product_choose] %}

                        <div class="w-full h-[220px] bg-gray-200 rounded-2xl overflow-hidden flex items-center justify-center mb-6 relative group">
                            {% if product.featured_image %}
                                <a href="{{ product.url }}" class="relative w-full h-full block">
                                    <img
                                        src="{{ product.featured_image | image_url: width: 600 }}"
                                        class="absolute top-1/2 left-1/2 min-w-full min-h-full -translate-x-1/2 -translate-y-1/2 object-cover"
                                        width="{{ product.width }}"
                                        height="{{ product.height }}">
                                    
                                    <!-- Overlay  -->
                                    <div class="absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 
                                        transition-opacity duration-300 flex items-center justify-center">
                                        <span class="text-white text-lg md:text-xl font-semibold tracking-wider">
                                            SHOP NOW
                                        </span>
                                    </div>
                                </a>
                            {% endif %}
                        </div>

                        <!-- Stars -->
                        <div class="flex items-center gap-1 mb-4 py-3">
                            {% for i in (1..block.settings.stars) %}
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 fill-black" viewBox="0 0 20 20">
                                <path d="M10 15l-5.878 3.09L5.5 11.545 1 7.91l6.061-.88L10 1.5l2.939 5.53L19 7.91l-4.5 3.636 1.378 6.545z"/>
                            </svg>
                            {% endfor %}
                        </div>

                        <!-- Review -->
                        <div class="text-xs text-gray-600 mb-4 leading-relaxed lg:px-1 min-h-17 ">
                            {{ block.settings.comment }}
                        </div>

                        <!-- Username -->
                        <div class="text-xs font-semibold text-gray-800 mt-auto py-3">
                            {{ block.settings.user }}
                        </div>

                    </div>

                </div>
                {% endfor %}

            </div>

            <!-- Flechas -->
            <div class="flex justify-between absolute inset-0 items-center px-4 pointer-events-none z-20">
                <button class="prevBtn pointer-events-auto">‹</button>
                <button class="nextBtn pointer-events-auto">›</button>
            </div>

        </div>
    </div>
</div>

<style>
.full-bleed{
  width: 100vw;
  margin-left: calc(50% - 50vw);
  margin-right: calc(50% - 50vw);
}
</style>




<script>
document.addEventListener("DOMContentLoaded", function () {

  const sliders = document.querySelectorAll(".collection-content-reviews");

  sliders.forEach(slider => {

    const track = slider.querySelector(".sliderTrack");
    const prev = slider.querySelector(".prevBtn");
    const next = slider.querySelector(".nextBtn");

    if (!track) return;

    let currentIndex = 0;

    function getSlideWidth() {
      const firstSlide = track.children[0];
      if (!firstSlide) return 0;
      return firstSlide.offsetWidth;
    }

    function getVisibleCount() {
      const sliderWidth = slider.offsetWidth;
      const slideWidth = getSlideWidth();
      return Math.floor(sliderWidth / slideWidth);
    }

    function getMaxIndex() {
      return Math.max(track.children.length - getVisibleCount(), 0);
    }

    function updateSlider() {
      const slideWidth = getSlideWidth();
      track.style.transform =
        `translateX(-${currentIndex * slideWidth}px)`;
    }

    next?.addEventListener("click", function () {
      currentIndex =
        currentIndex >= getMaxIndex() ? 0 : currentIndex + 1;
      updateSlider();
    });

    prev?.addEventListener("click", function () {
      currentIndex =
        currentIndex <= 0 ? getMaxIndex() : currentIndex - 1;
      updateSlider();
    });

    window.addEventListener("resize", function () {
      currentIndex = 0;
      updateSlider();
    });

  });

});
</script>




{% schema %}

{
  "name": "Reviews",
  "settings": [ 
    {
        "type": "text",
        "id": "title",
        "label": "Title",
        "default": "Loved by everyone, everywhere. Don't miss out"
    }
   ],
  "blocks": [
    {
      "type": "producto",
      "name": "Producto",
      "settings": [
        {
          "type": "image_picker",
          "id": "image_banner",
          "label": "Image"
        },
        {
          "type": "product",
          "id": "product_choose",
          "label": "Product",
        },
        {
          "type": "richtext",
          "id": "comment",
          "label": "Review",
        },
        {
          "type": "text",
          "id": "user",
          "label": "User name", 
          "default": "Shop now"
        },
        {
            "type": "range",
            "id": "stars",
            "label": "Number of stars",
            "min": 1,
            "max": 5,
            "step": 1,
            "default": 5
        }

        
      ]
    }
  ],
  "presets": [
    {
      "name": "Reviews",
      "category": "main"
    }
  ]
}
{% endschema %}